import{c as m,u as _,a as b,r as c,b as M,y as u,j as e,A as C,L as E,s as O,d as B,e as R,M as z,P as A,f as T,O as $}from"./index-CKVVWjem.js";import{L as H}from"./LayoutHelmet-4HzDdUkg.js";import{D as q,a as F,b as I}from"./DialogTitle-BXbl9MSU.js";import{H as U}from"./heart-CuBDccuX.js";import{B as Q}from"./Button-_x2gsRkF.js";/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],K=m("House",W);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]],G=m("LogOut",V);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],X=m("Search",J);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],Z=m("SquarePlus",Y);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]],se=m("TrendingDown",ee),te=({open:w,setOpen:i})=>{const[k,{data:D,isError:N,isLoading:n,isSuccess:o}]=_(),{user:t}=b(s=>s.auth),{posts:L}=b(s=>s.post),x=c.useRef(null),[h,f]=c.useState(null),[l,p]=c.useState(""),[d,g]=c.useState(null),P=M(),j=async s=>{if(!h||!(l!=null&&l.trim())){u.error("Please select an image and enter a caption");return}const r=new FormData;r.append("caption",l),h&&r.append("image",h);try{const a=await k(r).unwrap();P(O([a==null?void 0:a.post,...L])),u.success("Post created successfully")}catch(a){console.error("RTK Query error:",a),u.error("Failed to create post")}},y=s=>{var a;const r=(a=s.target.files)==null?void 0:a[0];if(r){f(r);const v=URL.createObjectURL(r);g(v)}};return c.useEffect(()=>{o&&(u.success("Post created successfully"),i(!1),f(null),g(null),p("")),N&&u.error("Failed to create post")},[N,o]),e.jsx("div",{children:e.jsx(q,{open:w,onClose:()=>i(!1),fullWidth:!0,children:e.jsxs(F,{children:[e.jsx(I,{className:"text-center font-semibold",children:"Create New Post"}),e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsx(C,{src:t==null?void 0:t.profilePicture}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-semibold text-xs",children:t==null?void 0:t.username}),e.jsx("span",{className:"text-gray-600 text-xs",children:t==null?void 0:t.bio})]})]}),e.jsxs("div",{className:"flex flex-col w-full mt-6",children:[e.jsx("textarea",{rows:5,className:"focus-visible:ring-transparent outline-none border border-blue-400 p-3 rounded w-full",placeholder:"Write a caption...",onChange:s=>p(s.target.value)}),d&&e.jsx("div",{className:"border border-red-500 h-56 w-full",children:e.jsx("img",{src:d,alt:"Preview",className:"w-full h-full object-cover"})}),e.jsx("input",{ref:x,type:"file",className:"hidden",onChange:y}),e.jsx("button",{onClick:()=>x.current.click(),variant:"outline",className:"w-fit mx-auto bg-[#0095f6] hover:bg-[#258bcf] p-3 rounded-md text-white mt-3",children:"Select from computer"}),d&&e.jsx("button",{disabled:n,variant:"outline",className:"w-full mx-auto p-3 rounded-md text-white mt-3 bg-[#222d42] hover:bg-[#364052]",onClick:j,children:n?e.jsx(E,{className:"animate-spin inline"}):"Post"})]})]})})})},ae=()=>{const[w,{data:i,isLoading:k,isError:D,isSuccess:N}]=B(),n=R(),{user:o}=b(s=>s.auth),{likeNotification:t}=b(s=>s.rtn),[L,x]=c.useState(!1),h=[{icon:e.jsx(K,{}),text:"Home"},{icon:e.jsx(X,{}),text:"Search"},{icon:e.jsx(se,{}),text:"Explore"},{icon:e.jsx(z,{}),text:"Message"},{icon:e.jsx(U,{}),text:"Notifications"},{icon:e.jsx(Z,{}),text:"Create"},{icon:e.jsx(C,{className:"w-6 h-6",src:(o==null?void 0:o.profilePicture)||"https://bit.ly/sage-adebayo",height:"100%",width:"100%"}),text:"Profile"},{icon:e.jsx(G,{}),text:"Logout"}],f=M(),l=s=>{s==="Logout"?(w(),f(T()),u.success((i==null?void 0:i.message)||"Logout Success"),n("/login")):s==="Create"?x(!0):s==="Profile"?n(`/profile/${o==null?void 0:o._id}`):s==="Home"?n("/"):s==="Message"&&n("/chat")},[p,d]=c.useState(null),g=s=>{d(s.currentTarget)},P=()=>{d(null)},j=!!p,y=j?"simple-popover":void 0;return e.jsx(H,{title:"Left Sidebar",description:"left sidebar",children:e.jsxs("div",{className:"fixed top-0 z-10 left-0 px-4 border-r border-r-gray-500 w-[16%] h-screen",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h1",{className:"my-8 pl-3 font-bold text-xl",children:"Logo"}),e.jsx("div",{children:h.map((s,r)=>e.jsxs("div",{onClick:()=>l(s==null?void 0:s.text),className:"flex items-center gap-3 relative hover:bg-gray-200 cursor-pointer rounded-lg p-3 my-3",children:[s.icon,e.jsx("span",{children:s.text}),(s==null?void 0:s.text)==="Notifications"&&(t==null?void 0:t.length)>0&&e.jsxs("div",{children:[e.jsx(Q,{"aria-describedby":y,variant:"contained",onClick:g,children:t==null?void 0:t.length}),e.jsx(A,{id:y,open:j,anchorEl:p,onClose:P,anchorOrigin:{vertical:"bottom",horizontal:"left"},children:t==null?void 0:t.map(a=>{var v,S;return e.jsxs("div",{className:"flex px-2 items-center gap-2 my-2",children:[e.jsx(C,{src:(v=a.userDetails)==null?void 0:v.profilePicture}),e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-bold",children:(S=a.userDetails)==null?void 0:S.username})," liked your post"]})]},a.userId)})})]})]},r))})]}),e.jsx(te,{open:L,setOpen:x})]})})},le=()=>e.jsx(H,{title:"MainLayout",description:"this is MainLayout",children:e.jsxs("div",{children:[e.jsx(ae,{}),e.jsx("div",{children:e.jsx($,{})})]})});export{le as default};
